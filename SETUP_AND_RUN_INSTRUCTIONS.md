# Inner DNA App - Local Setup & Run Instructions (macOS)

This guide provides detailed instructions to set up and run the Inner DNA application locally on a macOS environment. This setup uses an in-memory backend for authentication, meaning user data will not persist if the backend server restarts.

## 1. Prerequisites

Before you begin, ensure you have the following installed:

*   **macOS:** These instructions are tailored for macOS.
*   **Node.js:** Version 18.x LTS or newer is recommended.
    *   Check your version: `node -v`
    *   If not installed, download from [https://nodejs.org/](https://nodejs.org/).
*   **pnpm:** This project uses `pnpm` for package management and monorepo workspaces.
    *   Install `pnpm` globally using npm (which comes with Node.js):
        ```bash
        npm install -g pnpm
        ```
    *   Verify installation: `pnpm -v`

## 2. Project Directory and File Creation

You will need to manually create the directory structure and files, then copy-paste the code content provided in the previous "Output" steps.

1.  **Create Root Project Folder:**
    Open your terminal and run:
    ```bash
    mkdir inner-dna-app
    cd inner-dna-app
    ```

2.  **Create Core Package Structure:**
    Inside `inner-dna-app`, create the `packages` directory and its subdirectories for `client` and `server`. Also create the `shared` directory for types.
    ```bash
    mkdir -p packages/client/src packages/server/src packages/shared/types
    ```

3.  **Create Individual Files and Populate Content:**
    This is the most crucial step. You need to create each file in its correct path and copy-paste the exact content provided in the markdown files generated by the AI assistant in the previous steps:

    *   **Root Configuration Files:**
        *   `inner-dna-app/package.json`
        *   `inner-dna-app/pnpm-workspace.yaml`
        *   `inner-dna-app/.prettierrc.json`
        *   `inner-dna-app/.gitignore`
        *   `inner-dna-app/README.md`
        *(Refer to content from "Output Conceptual Root Configuration Files" step / `COMPLETE_PROJECT_OUTPUT_AND_SETUP.md`)*

    *   **Minimal In-Memory Backend Server Files (`packages/server/`):**
        *   `packages/server/package.json`
        *   `packages/server/tsconfig.json`
        *   `packages/server/.env.example`
        *   `packages/server/.eslintrc.cjs`
        *   `packages/server/.prettierrc.json` (can be omitted if root prettier config is used and works for server)
        *   `packages/server/src/index.ts`
        *   `packages/server/src/api/routes/authRoutes.ts`
        *   `packages/server/src/controllers/authController.ts` (the in-memory version)
        *(Refer to content from "Output Minimal In-Memory Backend Server Files" step / `COMPLETE_PROJECT_OUTPUT_AND_SETUP.md`)*
        **Important:** Ensure you are using the backend files configured for **in-memory authentication** (no MongoDB code).

    *   **Client Application Files (`packages/client/`):**
        *   `packages/client/index.html`
        *   `packages/client/package.json`
        *   `packages/client/vite.config.ts`
        *   `packages/client/src/test-setup.ts` (Create this file for Vitest setup)
        *   `packages/client/tsconfig.json`
        *   `packages/client/tsconfig.node.json`
        *   `packages/client/.eslintrc.cjs`
        *   `packages/client/.env.example`
        *   `packages/client/src/main.tsx`
        *   `packages/client/src/App.tsx`
        *   `packages/client/src/App.css`
        *   `packages/client/src/index.css`
        *   `packages/client/src/styles/variables.css`
        *   `packages/client/src/styles/globals.css`
        *   `packages/client/src/services/api.ts`
        *   **All component files** (`.tsx` and `.module.css`) in `packages/client/src/components/` (auth, common, detail, color, building, foundation, layout, results, welcome).
        *   **All store files** in `packages/client/src/contexts/store/` (`useAuthStore.ts`, `useAssessmentStore.ts`).
        *   **All library files** in `packages/client/src/lib/` (data files like `personalityData.ts`, utils like `colorUtils.ts`, `personalityCalculations.ts`).
        *   **All page files** in `packages/client/src/pages/` (Welcome, Assessment sub-pages, Profile, static pages).
        *   **All icon files** in `packages/client/src/assets/icons/` (CheckmarkIcon, report icons).
        *(Refer to content from "Output Client-Side Configuration Files", "Output Core Client CSS Files", "Output Client App Root Files", "Output Client Service/Library Files", and the various "Output ... Components" steps / or the single `COMPLETE_PROJECT_OUTPUT_AND_SETUP.md` if it contained all client code).*

    *   **Shared Types (`packages/shared/types/`):**
        *   `packages/shared/types/assessment.types.ts`
        *(Refer to content from "Output Shared TypeScript Type Definitions" step / `COMPLETE_PROJECT_OUTPUT_AND_SETUP.md`)*

    **Tip:** For each file, ensure you are in the `inner-dna-app` root directory in your terminal, then use a command like `touch path/to/your/file.ext` to create it, and then open it in a code editor to paste the content.

## 3. Install Dependencies

Once all files are created with their correct content:

1.  Navigate to the root project folder (`inner-dna-app`) in your terminal (if you aren't already there).
2.  Run the following command to install all dependencies for the root workspace and all defined packages (`client` and `server`):
    ```bash
    pnpm install
    ```
    This command reads the `package.json` files in the root and in each package, and installs the listed dependencies.

## 4. Environment Variable Setup

You need to create `.env` files from the example files and configure them.

1.  **Server Environment Variables:**
    *   Navigate to the server package:
        ```bash
        cd packages/server
        ```
    *   Copy the example file to a new `.env` file:
        ```bash
        cp .env.example .env
        ```
    *   Open the newly created `packages/server/.env` file in your code editor.
    *   **Crucially, you MUST set strong, random secrets for `JWT_SECRET` and `REFRESH_TOKEN_SECRET`.** You can use a password generator to create these.
        ```ini
        # packages/server/.env
        PORT=3001
        NODE_ENV=development
        JWT_SECRET=your_very_long_random_strong_secret_for_jwt_signing # REPLACE THIS
        JWT_EXPIRES_IN=1h
        REFRESH_TOKEN_SECRET=your_other_very_long_random_strong_secret_for_refresh_tokens # REPLACE THIS
        REFRESH_TOKEN_EXPIRES_IN=7d
        CLIENT_ORIGIN=http://localhost:3000 # Ensure this matches your Vite client's port (Vite often defaults to 5173 if 3000 is taken)
        ```
    *   Navigate back to the root directory:
        ```bash
        cd ../..
        ```

2.  **Client Environment Variables:**
    *   Navigate to the client package:
        ```bash
        cd packages/client
        ```
    *   Copy the example file:
        ```bash
        cp .env.example .env
        ```
    *   Open `packages/client/.env`. The default value should generally be correct if your server runs on port 3001 and your client on port 3000 (or 5173).
        ```ini
        # packages/client/.env
        VITE_API_BASE_URL=http://localhost:3001/api
        ```
    *   Navigate back to the root directory:
        ```bash
        cd ../..
        ```

## 5. Running the Application

You'll need two separate terminal windows or tabs to run the backend server and the frontend client simultaneously. Make sure both terminals are navigated to the project root (`inner-dna-app`).

*   **Terminal 1: Start the Backend Server**
    ```bash
    pnpm dev:server
    ```
    You should see log output similar to:
    `[server]: Server is running at http://localhost:3001 (IN-MEMORY AUTH MODE)`
    `[server]: CORS enabled for origin: http://localhost:3000` (or your client port)
    If you see warnings about JWT secrets not being defined, ensure your `packages/server/.env` file is correctly set up.

*   **Terminal 2: Start the Frontend Client (Vite Dev Server)**
    ```bash
    pnpm dev:client
    ```
    Vite will compile the client application and start its development server. The output will show the URL where the client is being served, typically:
    `Local: http://localhost:3000/` (or `http://localhost:5173/` if port 3000 is in use).

6.  **Open in Browser:**
    *   Open your web browser (Chrome, Firefox, Safari, Edge) and navigate to the local URL provided by the Vite dev server (e.g., `http://localhost:3000` or `http://localhost:5173`).

## 6. Expected Behavior

*   You should see the Inner DNA Welcome Page.
*   **In-Memory Authentication:** User registration and login will function using the in-memory backend. This means any users you register will only exist as long as the backend server is running. If you restart the backend server, registered users will be lost.
*   You should be able to proceed through the entire multi-phase assessment (Foundation Stones, Building Blocks, Color Palettes, Detail Elements).
*   The Results page should display the visual tower (2D SVG) and the textual report based on your selections.
*   All GDS styles, typography, and animations (as implemented) should be observable.

## 7. Troubleshooting (Optional Tips)

*   **Node.js/pnpm Versions:** If you encounter issues, ensure your Node.js version is LTS (e.g., 18.x or 20.x) and pnpm is up to date (`pnpm install -g pnpm`).
*   **`.env` Files:** Double-check that your `.env` files are correctly named (`.env`, not `.env.txt` or similar), are in the correct locations (`packages/server/` and `packages/client/`), and that the variables are correctly set (especially JWT secrets).
*   **`pnpm install` Issues:** If `pnpm install` fails or you suspect corrupted dependencies:
    *   Delete the root `node_modules` folder.
    *   Delete the `pnpm-lock.yaml` file from the root.
    *   Run `pnpm install` again.
*   **Port Conflicts:** If port 3000 or 3001 is in use by another application, the servers might fail to start or Vite might pick a different port. Check terminal outputs. You can adjust the `PORT` in `packages/server/.env` and the `server.port` in `packages/client/vite.config.ts` if needed (remember to update `CLIENT_ORIGIN` and `VITE_API_BASE_URL` accordingly).
*   **Terminal Output:** Always check the output in both server and client terminals for any error messages. These often provide clues to what might be wrong.
*   **Browser Developer Console:** Open your browser's developer console (usually by right-clicking and selecting "Inspect" or "Inspect Element", then going to the "Console" tab) for any client-side error messages.

Enjoy reviewing the Inner DNA application!
